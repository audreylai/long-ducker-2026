{% extends "base.html" %}

{% block content %}
{% set hero_lion = highlight_lions|first %}
<section class="grid gap-10 lg:grid-cols-[1.1fr_0.9fr] items-start">
	<div class="space-y-6">
		<p class="text-sm uppercase tracking-[0.4em] text-harrowBlue/70">{{ long_ducker_date }} • Long Ducker</p>
		<div class="space-y-4">
			<h2 class="text-4xl sm:text-5xl font-serif text-harrowBlue">Bring the pride home for Long Ducker</h2>
			<p class="text-lg text-slate-700 leading-relaxed">Bid on student-designed lion sculptures, fuel creative programmes, and keep the Long Ducker tradition roaring. The entire auction runs online so every supporter can participate from anywhere.</p>
		</div>
		<div class="flex flex-wrap gap-4">
			<a href="{{ url_for('lions_catalog') }}" class="px-6 py-3 rounded-full bg-harrowGold text-harrowBlue font-semibold shadow-lg shadow-harrowGold/40">Browse the catalogue</a>
			<a href="#auction-info" class="px-6 py-3 rounded-full border border-harrowBlue/30 text-harrowBlue font-semibold">How bidding works</a>
		</div>
		<div class="grid gap-4 sm:grid-cols-3">
			<div class="bg-white/80 backdrop-blur rounded-2xl p-4 shadow-sm">
				<p class="text-xs uppercase tracking-wide text-slate-500">Raised so far</p>
				<p class="text-3xl font-serif text-harrowBlue">${{ '{:,.0f}'.format(total_raised) }}</p>
			</div>
			<div class="bg-white/80 backdrop-blur rounded-2xl p-4 shadow-sm">
				<p class="text-xs uppercase tracking-wide text-slate-500">Highest bid</p>
				{% if top_bid %}
				<p class="text-lg font-semibold text-harrowBlue">{{ top_bid.lion }}</p>
				<p class="text-2xl font-serif text-harrowGold">${{ '{:,.0f}'.format(top_bid.amount) }}</p>
				{% else %}
				<p class="text-2xl font-serif text-harrowBlue">-</p>
				{% endif %}
			</div>
			<div class="bg-white/80 backdrop-blur rounded-2xl p-4 shadow-sm">
				<p class="text-xs uppercase tracking-wide text-slate-500">Online access</p>
				<p class="text-lg font-semibold text-harrowBlue">Portal open 24/7</p>
				<p class="text-sm text-slate-500">Place bids or increase pledges anytime before closing.</p>
			</div>
		</div>
	</div>
	<div class="space-y-4 h-full">
		<div class="relative overflow-hidden rounded-4xl bg-slate-200 shadow-xl min-h-90 h-full" id="spotlight-slider">
			{% if highlight_lions %}
				{% for lion in highlight_lions %}
				<article class="absolute inset-0 h-full w-full transition-opacity duration-700 ease-out {% if loop.first %}opacity-100{% else %}opacity-0 pointer-events-none{% endif %}" data-spotlight-slide>
					<img src="{{ lion.image_url or 'https://images.unsplash.com/photo-1470246973918-29a93221c455?auto=format&fit=crop&w=1200&q=80' }}" alt="{{ lion.name }} sculpture" class="h-full w-full object-cover" />
					<div class="absolute inset-x-0 bottom-0 bg-linear-to-t from-harrowBlue/90 via-harrowBlue/60 to-transparent p-6 text-white">
						<p class="text-xs uppercase tracking-[0.4em] text-white/70">Spotlight</p>
						<div class="flex items-center justify-between gap-4">
							<div>
								<p class="text-2xl font-serif">{{ lion.name }}</p>
								<p class="text-sm text-white/80">House {{ lion.house }}</p>
							</div>
							<span class="text-lg font-semibold text-harrowGold">${{ '{:,.0f}'.format(lion.current_bid or 0) }}</span>
						</div>
						<p class="mt-3 text-sm text-white/80">{{ lion.summary }}</p>
					</div>
				</article>
				{% endfor %}
			{% else %}
				<div class="flex h-full items-center justify-center p-6 text-center text-slate-600">Spotlight lions will appear here soon.</div>
			{% endif %}
		</div>
		{% if highlight_lions|length > 1 %}
		<div class="flex justify-center gap-2" id="spotlight-dots">
			{% for lion in highlight_lions %}
			<button type="button" class="h-2.5 w-2.5 rounded-full border border-white/50 bg-white/40 transition {% if loop.first %}bg-white{% endif %}" aria-label="Show {{ lion.name }}" data-spotlight-dot="{{ loop.index0 }}"></button>
			{% endfor %}
		</div>
		{% endif %}
	</div>
</section>

<section class="mt-16 grid gap-8 lg:grid-cols-[1.2fr_0.8fr]">
	<div class="bg-white/90 rounded-3xl p-6 shadow-sm border border-white/60">
		<p class="text-xs uppercase tracking-[0.4em] text-harrowBlue/70">Live auction flow</p>
		<h3 class="mt-2 text-2xl font-serif text-harrowBlue">How you can take part</h3>
		<ol class="mt-6 space-y-4">
			<li class="flex gap-4">
				<span class="h-10 w-10 rounded-full bg-harrowBlue text-white font-semibold flex items-center justify-center">1</span>
				<div>
					<p class="font-semibold text-harrowBlue">Browse the pride</p>
					<p class="text-sm text-slate-600">Review artist statements, reserve prices, and current bids for each lion.</p>
				</div>
			</li>
			<li class="flex gap-4">
				<span class="h-10 w-10 rounded-full bg-harrowGold text-harrowBlue font-semibold flex items-center justify-center">2</span>
				<div>
					<p class="font-semibold text-harrowBlue">Submit a bid pledge</p>
					<p class="text-sm text-slate-600">Share your contact details so the auctioneer can validate increments instantly.</p>
				</div>
			</li>
			<li class="flex gap-4">
				<span class="h-10 w-10 rounded-full bg-harrowBlue text-white font-semibold flex items-center justify-center">3</span>
				<div>
					<p class="font-semibold text-harrowBlue">Follow the live ticker</p>
					<p class="text-sm text-slate-600">Watch bids update in real time on the website, and wait to be contacted once bidding closes!</p>
				</div>
			</li>
		</ol>
	</div>
	<div class="rounded-3xl overflow-hidden shadow-lg border border-white/40">
		<img src="{{ url_for('static', filename='images/logo.png') }}" alt="Lion studio process" class="h-full w-full object-cover" />
	</div>
</section>

<section id="auction-info" class="mt-16 grid gap-6 md:grid-cols-2">
 	<article class="bg-white rounded-3xl p-6 shadow-sm border border-white/60">
		<p class="text-xs uppercase tracking-[0.4em] text-harrowBlue/60">About Long Ducker</p>
		<h3 class="mt-2 text-xl font-serif text-harrowBlue">Community tradition</h3>
		<p class="mt-4 text-sm text-slate-600">Long Ducker unites students, families, and alumni to fund scholarships, arts labs, and service expeditions. Every lion bid goes straight back to these programmes.</p>
	</article>
	<article class="bg-white rounded-3xl p-6 shadow-sm border border-white/60">
		<p class="text-xs uppercase tracking-[0.4em] text-harrowBlue/60">Key dates</p>
		<h3 class="mt-2 text-xl font-serif text-harrowBlue">Digital auction timeline</h3>
		<ul class="mt-4 space-y-2 text-sm text-slate-600">
			<li>Catalogue published: 12 Feb</li>
			<li>Bidding window: 15 Feb – 8 Mar</li>
			<li>Results notified: 9 Mar morning</li>
		</ul>
	</article>
</section>

<script>
document.addEventListener('DOMContentLoaded', () => {
	const slider = document.getElementById('spotlight-slider');
	if (!slider) {
		return;
	}
	const slides = Array.from(slider.querySelectorAll('[data-spotlight-slide]'));
	const dots = Array.from(document.querySelectorAll('[data-spotlight-dot]'));
	if (slides.length <= 1) {
		return;
	}
	let active = 0;
	const setActive = (index) => {
		slides.forEach((slide, idx) => {
			const isActive = idx === index;
			slide.classList.toggle('opacity-0', !isActive);
			slide.classList.toggle('opacity-100', isActive);
			slide.classList.toggle('pointer-events-none', !isActive);
		});
		dots.forEach((dot, idx) => {
			dot.classList.toggle('bg-white', idx === index);
			dot.classList.toggle('bg-white/40', idx !== index);
		});
		active = index;
	};

	const tick = () => {
		const next = (active + 1) % slides.length;
		setActive(next);
	};

	let intervalId = setInterval(tick, 10000);

	const goTo = (index) => {
		setActive(index);
		clearInterval(intervalId);
		intervalId = setInterval(tick, 10000);
	};

	dots.forEach((dot) => {
		dot.addEventListener('click', () => {
			const target = Number(dot.dataset.spotlightDot);
			if (!Number.isNaN(target)) {
				goTo(target);
			}
		});
	});
});
</script>
{% endblock %}
